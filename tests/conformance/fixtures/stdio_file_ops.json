{
  "version": "v1",
  "family": "stdio_file_ops",
  "captured_at": "2026-02-13T00:00:00Z",
  "description": "Mode-specific parity fixtures for stdio file operations (fopen, fclose, fread, fwrite, fgets, fputs, fseek, ftell, fflush). Strict: host-glibc parity. Hardened: invalid mode repair, buffering fallbacks.",
  "cases": [
    {
      "name": "fopen_valid_mode_strict",
      "function": "fopen",
      "spec_section": "C11 7.21.5.3 fopen",
      "inputs": { "filename": "/dev/null", "mode": "r" },
      "expected_output": "STREAM_OPENED",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fopen_invalid_path_strict",
      "function": "fopen",
      "spec_section": "C11 7.21.5.3 fopen",
      "inputs": { "filename": "/nonexistent/path/file.txt", "mode": "r" },
      "expected_output": "NULL",
      "expected_errno": 2,
      "mode": "strict"
    },
    {
      "name": "fclose_valid_strict",
      "function": "fclose",
      "spec_section": "C11 7.21.5.1 fclose",
      "inputs": { "stream": "valid_devnull" },
      "expected_output": "0",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fprintf_devnull_strict",
      "function": "fprintf",
      "spec_section": "C11 7.21.6.1 fprintf",
      "inputs": { "stream": "devnull", "format": "hello %d", "args": [42] },
      "expected_output": "8",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "snprintf_basic_strict",
      "function": "snprintf",
      "spec_section": "C11 7.21.6.5 snprintf",
      "inputs": { "size": 32, "format": "test %s %d", "args": ["abc", 123] },
      "expected_output": "test abc 123",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "snprintf_truncation_strict",
      "function": "snprintf",
      "spec_section": "C11 7.21.6.5 snprintf",
      "inputs": { "size": 5, "format": "hello world" },
      "expected_output": "hell",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fwrite_devnull_strict",
      "function": "fwrite",
      "spec_section": "C11 7.21.8.2 fwrite",
      "inputs": { "stream": "devnull", "size": 1, "nmemb": 4, "payload": [65, 66, 67, 68] },
      "expected_output": "4",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fread_devzero_strict",
      "function": "fread",
      "spec_section": "C11 7.21.8.1 fread",
      "inputs": { "stream": "devzero", "size": 1, "nmemb": 4 },
      "expected_output": "items=4;data=[0, 0, 0, 0]",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fseek_devnull_rw_strict",
      "function": "fseek",
      "spec_section": "C11 7.21.9.2 fseek",
      "inputs": { "stream": "devnull_rw", "offset": 3, "whence": 0 },
      "expected_output": "0",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "ftell_after_seek_strict",
      "function": "ftell",
      "spec_section": "C11 7.21.9.4 ftell",
      "inputs": { "stream": "devnull_rw", "seek_offset": 7 },
      "expected_output": "0",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fflush_devnull_strict",
      "function": "fflush",
      "spec_section": "C11 7.21.5.2 fflush",
      "inputs": { "stream": "devnull", "payload": [65, 66, 67] },
      "expected_output": "0",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "fopen_valid_mode_hardened",
      "function": "fopen",
      "spec_section": "C11 7.21.5.3 fopen",
      "inputs": { "filename": "/dev/null", "mode": "r" },
      "expected_output": "STREAM_OPENED",
      "expected_errno": 0,
      "mode": "hardened"
    },
    {
      "name": "snprintf_basic_hardened",
      "function": "snprintf",
      "spec_section": "C11 7.21.6.5 snprintf",
      "inputs": { "size": 32, "format": "val=%d", "args": [99] },
      "expected_output": "val=99",
      "expected_errno": 0,
      "mode": "hardened"
    },
    {
      "name": "fflush_devnull_hardened",
      "function": "fflush",
      "spec_section": "C11 7.21.5.2 fflush",
      "inputs": { "stream": "devnull", "payload": [88, 89] },
      "expected_output": "0",
      "expected_errno": 0,
      "mode": "hardened"
    },
    {
      "name": "fread_devzero_hardened",
      "function": "fread",
      "spec_section": "C11 7.21.8.1 fread",
      "inputs": { "stream": "devzero", "size": 1, "nmemb": 2 },
      "expected_output": "items=2;data=[0, 0]",
      "expected_errno": 0,
      "mode": "hardened"
    }
  ]
}
