{
  "cve_id": "CVE-2021-3156",
  "test_name": "sudo_baron_samedit_heap_overflow",
  "category": "external",
  "software": "sudo",
  "software_version": "1.9.5p1",
  "description": "Heap-based buffer overflow in sudoedit -s argument parsing allows local privilege escalation",
  "cwe_ids": ["CWE-122", "CWE-787"],
  "cvss_score": 7.8,
  "build_cmd": "docker build -t cve-arena-sudo .",
  "run_cmd": "./trigger.sh",
  "ld_preload_mode": true,
  "expected_stock": {
    "crashes": true,
    "signal": "SIGSEGV",
    "description": "set_cmnd() writes past the end of the heap-allocated command buffer due to improper backslash-escape handling; heap metadata corruption leads to SIGSEGV/SIGABRT or exploitable condition for local root"
  },
  "expected_tsm": {
    "crashes": false,
    "exit_code": 0,
    "healing_actions": [
      "ClampSize",
      "TruncateWithNull"
    ],
    "description": "Allocation fingerprint canary detects heap corruption past chunk boundary; ClampSize prevents the overflow write; TruncateWithNull ensures the overlong argument is safely terminated"
  },
  "tsm_features_tested": [
    "allocation_fingerprint",
    "canary_verification",
    "heap_overflow_detection",
    "clamp_size_healing",
    "truncate_with_null"
  ]
}
